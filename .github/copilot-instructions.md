# Copilot Instructions for npm-ts-template

## Repository Overview

This is a modern TypeScript npm package template designed to provide a production-ready starting point for creating npm packages. It uses ESM (ES Modules), includes comprehensive testing, linting, and formatting tools.

## Tech Stack

- **Language**: TypeScript 5.8+
- **Module System**: ES Modules (ESM)
- **Testing**: Jest with ts-jest
- **Linting**: ESLint 9.x with TypeScript support
- **Formatting**: Prettier 3.x
- **Build Tool**: TypeScript Compiler (tsc)

## Project Structure

- `src/` - Source TypeScript files
  - `src/index.ts` - Main entry point
- `tests/` - Test files (*.spec.ts)
- `dist/` - Compiled output (git-ignored, generated by build)
- Configuration files in root

## Development Guidelines

### Code Style

- Use TypeScript with strict type checking
- Follow ESM import/export syntax
- Use `type` imports when importing only types: `import type { Type } from './module'`
- Maintain 100% test coverage where possible
- Use descriptive variable and function names
- Add JSDoc comments for public APIs

### Testing Requirements

- All new features must include tests
- Tests should be placed in `tests/` directory with `.spec.ts` extension
- Use Jest for testing
- Coverage thresholds:
  - Lines: 90%
  - Statements: 90%
  - Branches: 80%
  - Functions: 90%
- Run tests with: `npm test`
- Watch mode: `npm run test:watch`
- Coverage report: `npm run test:coverage`

### Linting and Formatting

- **Always run linting before committing**: `npm run lint`
- Fix linting issues automatically: `npm run lint:fix`
- Format code with Prettier: `npm run format`
- Check formatting: `npm run format:check`
- ESLint configuration is in `eslint.config.js` (flat config format)
- Prettier configuration is in `.prettierrc.json`

### Build Process

- Build command: `npm run build`
- Clean build artifacts: `npm run clean`
- The build process:
  1. Cleans the `dist/` directory
  2. Compiles TypeScript to JavaScript with type declarations
- Output goes to `dist/` directory
- `prepare` script runs build automatically on `npm install`

### TypeScript Configuration

- `tsconfig.json` - Main TypeScript configuration for building
- `tsconfig.eslint.json` - TypeScript configuration for ESLint
- Target: ES2020
- Module: ES2020 (ESM)
- Strict mode enabled
- Generate declaration files (.d.ts)

### Common Commands

```bash
npm install          # Install dependencies (also runs build)
npm test            # Run tests
npm run test:watch  # Run tests in watch mode
npm run lint        # Lint code
npm run lint:fix    # Fix linting issues
npm run format      # Format code with Prettier
npm run build       # Build the project
npm run clean       # Remove dist/ directory
```

### Making Changes

1. Write code in `src/`
2. Add tests in `tests/`
3. Run `npm run lint:fix` to fix any linting issues
4. Run `npm run format` to format code
5. Run `npm test` to ensure tests pass
6. Run `npm run build` to verify the build works

### Package Publishing

- This is a template, not a publishable package itself
- Users should update `package.json` fields before publishing:
  - `name` (currently "REPLACE_ME")
  - `version`
  - `description`
  - `author`
  - `repository` URLs
- The `prepublishOnly` script ensures quality checks before publishing

## Important Notes

- This repository uses **ESM** (ES Modules), not CommonJS
- Configuration files use `.cjs` extension where CommonJS is required (e.g., `jest.config.cjs`)
- All source code should use `.ts` extension
- Don't commit `dist/`, `coverage/`, or `node_modules/` directories
- Maintain backward compatibility for template users
- Keep dependencies up to date but stable

## When Suggesting Changes

- Preserve the template nature of this repository
- Keep it simple and minimal - this is a starting point for others
- Ensure all changes work with ESM
- Update README.md if adding new features or commands
- Consider impact on users who have already used this template
- Test changes thoroughly with all npm scripts
- Maintain strict TypeScript types
- Follow existing code patterns and conventions
